<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="dstyle.css" />
  <title>Document</title>
</head>

<body>
  <div class="container">
    <div class="row">
    </div>
  </div>
  <div class="container my-3"><button class="btn btn-danger" id="priceArr">가격정렬</button></div>
  <div class="container my-3"><button class="btn btn-danger" id="namereturn">가나다 역순 정렬</button></div>
  <div class="container my-3"><button class="btn btn-danger" id="priceUnder">6만원 이하</button></div>
  <div class="container my-3"><button class="btn btn-danger" id="moreData">더보기</button></div>

  <script>
    //구매버튼을 누르면 장바구니에 상품명추가 실제 서비스면 서버로 보냈을듯함
    //데이터를 저장할 다른 공간을 만들어야하는데 가장 쉬운 곳은 변수인데 단점은 변수는 페이지 재로드시 초기화됨
    //데이터 영구적으로 저장하기에 적합하지 않음
    //반영구적으로 저장할 수 있는 방법이 있는데 그게 로컬스토리지임
    //브라우저에 저장할 수 있는 방법중
    //로컬스토리지랑 세션스토리지는 가장 쉽게 키: 밸류 형태로 데이터를 저장할 수있음
    //인덱스DB는 데이터가 크고 복잡하다 구조화된 대용량데이터 저장시 사용
    //쿠키는 보통로그인 정보 저장(인증정보)
    //캐시스토리지는 htms css js 파일 저장하는 곳임
    //로컬스토리지랑 세션스토리지 용량은 5MB 문자/숫자만 저장가능함 arr,obj 못넣음 넣으려고하면 강제로 문자열로바꿔줌
    //그런데 둘의 차이는 로컬스토리지는 사이트재접속해도 유지됨 세션스토리지는 사이트나가면 자동삭제됨
    //데이터를 저장하는 방법
    // localStorage.setItem('데이터이름', '데이터값')
    //데이터를 뽑고 싶다?
    // localStorage.getItem('데이터이름')
    //로컬스토리지 데이터를 삭제하고싶다?
    // localStorage.removeItem('데이터이름')
    //편법하나 알아보자 로컬스토리지에는 문자,숫자만 저장가능하다고 했지만 arr,obj자료형도 강제로 저장을 할 수 있음
    // localStorage.setItem('num', [1, 2, 3])
    //이렇게 저장하고 로컬스토리지에서 보면 강제로 대괄호를 없애고 문자열로 저장한걸 볼 수 있음 
    //어떤 편법이냐?
    //arr,obj를 만들고 이걸 JSON으로 변경하면됨
    // let arr = [1, 2, 3]
    //let newarr2 = JSON.stringify(arr)
    // localStorage.setItem('num', newarr2)
    //이렇게 저장하면 이 데이터를 꺼내도 잘 저장이 되어있음
    // let getItem = localStorage.getItem('num')
    //다만 이거는 arr이 아니라 문자인걸 인지해야함
    //그래서 자료를 꺼내고 싶어도 
    //console.log(getItem[0]) //이렇게 꺼내면 [ 이거 하나 나옴
    //그래서 다시 arr,obj로 변경해줘야함
    //이렇게 변환해주면 인덱싱도 가능
    // console.log(JSON.parse(getItem)[0])
    //세션스토리지 사용법은 로컬스토리지와 동일하고 이름만 로컬 -> 세션으로 변경해주면 끝!
    //로컬스토리지 데이터를 수정하고 싶으면?
    //수정을 쉽게 해주는 함수나 훅은 없지만 3단계를 걸쳐 수정을 할 수 있음
    //1. 자료꺼내기 2. 꺼낸거 수정하기 3. 다시넣기 
    //숙제1. 구매버튼 누르면 누른 상품면 로컬스토리지에 저장하기
    //힌트 구매버튼을 누르면 내 형제요소 찾는 법 알아봐야함 
    //로컬스토리지가 비어있을 때/ 뭐가 있을 때 저장방식을 다르게 짜야함
    //숙제2. cart.html 방문시 local스토리지에 저장된 상품명들 다 보여주기
    var products = [
      { id: 0, price: 70000, title: 'Blossom Dress' },
      { id: 1, price: 50000, title: 'Springfield Shirt' },
      { id: 2, price: 60000, title: 'Black Monastery' }
    ];

    let noarr = []
    let arr = JSON.stringify(noarr)


    let cardlist = document.querySelector('.row');
    let clickcount = 0


    포이치(products);

    let cartSave = document.querySelectorAll('.buy')
    products.forEach((item, index) => {
      cartSave[index].addEventListener('click', () => {
        if (!noarr.includes(item.title)) {
          noarr.push(item.title)
          arr = JSON.stringify(noarr)
          localStorage.setItem('cart', arr)
        }
        else {
          alert('이미있음')
        }


      })
    })


    function 포이치(runArr) {
      runArr.forEach(item => {
        let secCardList = `<div class="col-sm-4">
        <img src="https://placehold.co/600" class="w-100">
        <h5>${item.title}</h5>
        <p>가격 : ${item.price}</p>
        <button class='buy'>구매</button>
      </div>`
        cardlist.insertAdjacentHTML('beforeend', secCardList)
      });
    }


    document.querySelector('#priceArr').addEventListener('click', () => {
      products.sort((a, b) => { return a.price - b.price });
      cardlist.innerHTML = ''
      포이치(products);
      clickcount = 0
      document.querySelector('#moreData').style.display = 'block'
    })

    document.querySelector('#namereturn').addEventListener('click', () => {
      products.sort((a, b) => {
        return a.title > b.title ? -1 : 1
      })
      cardlist.innerHTML = ''
      포이치(products);
      clickcount = 0
      document.querySelector('#moreData').style.display = 'block'
    })


    let newarr = products.filter((a) => { return a.price <= 60000 });
    document.querySelector('#priceUnder').addEventListener('click', () => {
      cardlist.innerHTML = ''
      포이치(newarr);
    })


    document.querySelector('#moreData').addEventListener('click', () => {
      if (clickcount == 0) {
        fetch('https://codingapple1.github.io/js/more1.json').then(response => {
          return response.json();
        }).then(data => {

          포이치(data)
        })
      }

      else if (clickcount == 1) {
        fetch('https://codingapple1.github.io/js/more2.json').then(response => {
          return response.json();
        }).then(data => {
          포이치(data)
        })
        document.querySelector('#moreData').style.display = 'none'
      }

      clickcount += 1
    })




  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

</body>




</html>